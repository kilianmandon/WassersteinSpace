\subsection{Notation}
Für den Verlauf dieser Arbeit fixieren wir einen Zeit-Horizont $N \in \mathbb{N}$ und $p \in [1,\infty)$. Für $1\leq t \leq N$ sei $\mathcal{X}_t$ ein polnischer Raum mit einer kompatiblen Metrik $d_{\mathcal{X}_t}$. Für Mengen $\left(A_{i}\right)_{s\leq i \leq r}$ kürzen wir das kartesische Produkt ab durch
$$A_{s:r} := A_s \times ... \times A_r$$
Mit dieser Notation schreiben wir $\mathcal{X}:=\mathcal{X}_{1:N}$.

Für einen polnischen Raum $A$ mit kompatibler Metrik $d_A$ betrachten wir zwei Räume von Maßen: $\mathcal{P}(A)$, den Raum der Borel-Wahrscheinlichkeitsmaße auf $A$, und die Teilmenge $\mathcal{P}_p(A) \subset \mathcal{P}(A)$ der Wahrscheinlichkeitsmaße mit endlichem $p$-ten Moment, das heißt
$$\int d_A^p(a_0, x) \mu(dx) < \infty$$
für ein fixes (und damit für alle) $a_0 \in A$. Für zwei Wahrscheinlichkeitsmaße $\mu \in \mathcal{P}(A), \nu \in \mathcal{P}(B)$ schreiben wir $\cpl(\mu, \nu)$ für die Menge aller \emph{Kopplungen} von $\mu$ und $\nu$, das heißt Maße $\pi \in \mathcal{P}(A \times B)$ mit $\pi(\cdot, B)\equiv \mu$ und $\pi(A, \cdot)=\nu$.

\subsection{Wasserstein-Distanz}
\begin{definition}[Wasserstein-Distanz]\label{def:wasserstein_distance}
    Sei $A$ polnisch mit einer fixierten kompatiblen Metrik $d_A$. Die $p$-te Wasserstein"=Distanz zwischen zwei Wahrscheinlichkeitsmaßen $\mu, \nu \in \mathcal{P}_p(A)$ ist definiert als
    $$\mathcal{W}_p(\mu, \nu) := \left( \inf_{\pi \in \cpl(\mu, \nu)} \int d^p_A(x, y) \pi(dx, dy) \right)^\frac{1}{p}$$
\end{definition}
Wir versehen $\mathcal{P}(A)$ mit der Topologie von schwacher Konvergenz, das heißt eine Basis der Topologie sind Mengen $\{U_{f, x, r} \vert f \in C_b(A), x\in \mathbb{R}, r>0\}$ der Form 
$$U_{f, x, r} = \left\{ \mu \in \mathcal{P}(A) \vert \left| \int f d\mu - x\right| < r\right\}$$
Bezüglich dieser Topologie betrachten wir auf $\mathcal{P}(A)$ die Borel $\sigma$"=Algebra. Auf $\mathcal{P}_p(A)$ ist die Topologie induziert durch $\mathcal{W}_p$, und auch hier betrachten wir die assoziierte Borel $\sigma$-Algebra.
\begin{lemma}\label{thm:closed_couplings}
Seien $\mathcal{A,B}$ polnische Räume. Dann gilt: 
\begin{enumerate}
    \item Für $(\mu_n)_{n\in \mathbb{N}} \subset\mathcal{P}(A), \mu_n \rightarrow \mu \in \mathcal{P}(A)$ ist der Grenzwert eindeutig.
    \item Für $(\pi_n) \subset \mathcal{P}(\mathcal{A} \times \mathcal{B}), \pi_n \rightarrow \pi$ schwach konvergieren auch die Marginalien von $\pi_n$ schwach gegen die von $\pi$. 
    \item Für $\mu \in \mathcal{P}(\mathcal{A}), \nu \in \mathcal{P}(\mathcal{B})$ ist $\cpl(\mu, \nu)$ abgeschlossen.
\end{enumerate}
\end{lemma}
\begin{proof}
    Seien $\mu, \tilde{\mu}$ zwei Grenzwerte von $(\mu_n)$ in schwacher Konvergenz. Sei $E \subseteq \mathcal{A}$ abgeschlossen. Für $m \in \mathbb{N}$ betrachte die stetige Funktion 
    $$f_m: x \mapsto (1-m\cdot d(x,E)) \vee 0$$
    $f_m$ ist stetig und beschränkt, also gilt 
    $$\lim_{n \rightarrow \infty} \mu_n(f_m) = \mu(f_m) = \tilde{\mu}(f_m)$$
    Es konvergiert $f_m \rightarrow \mathds{1}_E$ fast sicher dominiert durch $1$, somit gilt also auch $\mu(E) =\tilde{\mu}(E)$. Da abgeschlossene Mengen ein $\cap$-stabiler Erzeuger sind, folgt $\mu=\tilde{\mu}$ und damit die erste Behauptung.

    Sei $(\pi_n)_{n\in\mathbb{N}} \subset \mathcal{P}(\mathcal{A}\times\mathcal{B})$ eine Folge und konvergent gegen $\pi$. Wir schreiben $\mu_n, \nu_n$ bzw. $\mu, \nu$ für die Marginalien von $\pi_n$ bzw. $\pi$. Sei $f\in C_b(\mathcal{A})$. Wir können $f \in C_b(\mathcal{A}\times\mathcal{B})$ auffassen als $x,y\mapsto f(x)$. Da $f$ stetig und beschränkt ist, gilt 
    $$\mu(f) = \pi(f) = \lim_{n\rightarrow \infty} \pi_n(f) = \lim_{n\rightarrow\infty} \mu_n(f)$$ 
    Daraus folgt die zweite Behauptung.

    Für eine Folge von Kopplungen $(\pi_n)_{n\in\mathbb{N}} \subset \cpl(\mu,\nu)$ konvergent gegen $\pi$ müssen also auch die Marginalien von $pi_n$ gegen die von $\pi$ konvergieren. Die Marginalien sind aber konstant $\mu$ und $\nu$, und wegen der Eindeutigkeit des Grenzwertes nach dem ersten Punkt gilt $\pi \in \cpl(\mu,\nu)$.
\end{proof}
\begin{lemma}\label{thm:optimal_coupling}
In \ref{def:wasserstein_distance} wird dass Infimum tatsächlich angenommen, das heißt es existiert ein $\pi \in \cpl(\mu, \nu)$, sodass
$$\mathcal{W}_p(\mu, \nu) = \left( \int d^p_A(x, y) \pi(dx, dy) \right)^{\frac{1}{p}}$$
Tatsächlich kann eine Borel-messbare Abbildung $k: \mathcal{P}_p(A) \times \mathcal{P}_p(A) \rightarrow \mathcal{P}_p(A\times A)$ gewählt werden, sodass für $\mu,\nu \in \mathcal{P}_p(A)$ $k(\mu, \nu)$ eine optimale Kopplung ist.
\end{lemma}
Für den Beweis benötigen wir den Satz von Prokhorov. Auf einem topologischen Raum $X$ mit Borel Algebra nennen wir eine Menge $M \subset \mathcal{P}(X)$ straff, falls für jedes $\varepsilon >0$ eine kompakte Menge $K\subset X$ existiert, sodass für jedes $\mu \in M$ gilt $\mu(X\setminus K) < \varepsilon$. Auf polnischen Räumen gibt der Satz von Prokhorov eine nützliche Charakterisierung von Straffheit:
\begin{theorem}[Satz von Prokhorov]\label{thm:prokhorov}
Sei $(A, d)$ ein polnischer Raum. Dann ist die Topologie schwacher Konvergenz auf $\mathcal{P}(A)$ vollständig metrisierbar und es gilt folgende Äquivalenz:

Eine Menge $M \subset \mathcal{P}(A)$ ist straff, genau dann wenn sie relativ kompakt ist.
\end{theorem}
\begin{proof}\ref{thm:optimal_coupling}
    \begin{enumerate}
        \item
    Zuerst zeigen wir die Existenz einer optimalen Kopplung. Seien $\mu, \nu \in \mathcal{P}_p(A)$. Die Mengen $\{\mu\}$ und $\{\nu\}$ sind straff nach dem Satz von Prokhorov, da sie bezüglich schwacher Konvergenz abgeschlossen und folgenkompakt sind. Wir können also für ein $\varepsilon > 0$ kompakte Mengen $K_1$ und $K_2$ wählen, sodass $\mu(A\setminus K_1) < \varepsilon$ und $\nu(A\setminus K_2) < \varepsilon$. Die Menge $K_1 \times K_2$ ist immer noch kompakt, und für $\pi \in \cpl(\mu, \nu)$ gilt 
    $$\pi(A\times A \setminus K_1 \times K_2) \leq \pi(A\times A \setminus K_1 \times A) + \pi(A\times A \setminus A \times K_2) \leq 2\varepsilon$$
    Also ist $\cpl(\mu, \nu)$ straff und mit dem Satz von Prokhorov relativ kompakt. Nach Lemma \ref{thm:closed_couplings} ist sind die Kopplungen auch abgeschlossen, also sogar kompakt. Wähle eine Folge $\pi_n\in \cpl(\mu, \nu)$ mit 
    $$\left(\mathbb{E}_{\pi_n}(d^p(x,y))\right)^{\frac{1}{p}} \rightarrow \mathcal{W}_p(\mu, \nu)$$
    Nach Übergang zu einer Teilfolge können wir annehmen, dass $\pi_n \rightarrow \pi \in \cpl(\mu, \nu)$. Für jedes $m \in \mathbb{N}$ ist $x,y\mapsto d^p(x,y)\wedge m$ stetig und beschränkt, also 
    $$\mathbb{E}_\pi(d^p(x,y)\wedge m) = \lim_{n\rightarrow \infty} \mathbb{E}_{\pi_n}(d^p(x,y) \wedge m) \leq \mathcal{W}_p^p(\mu, \nu)$$
    Für $m \rightarrow \infty$ folgt wegen dominierter Konvergenz $\mathbb{E}_\pi(d^p(x,y))\leq \mathcal{W}_p^p(\mu, \nu)$ und somit ist $\pi$ eine optimale Kopplung.
\item 
    Wir benutzen folgende Aussage über messbare Auswahl:

    \emph{Eine surjektive, Borel-messbare Abbildung $f$ zwischen polnischen Räumen, für die alle Fasern $f^{-1}(y)$ kompakt sind, hat eine Borel-messbare Rechtsinverse.}

    \end{enumerate}
    % TODO Proof optimal coupling
\end{proof}
\begin{definition}
    Sei $A$ ein polnischer Raum mit fixierter Metrik $d_A$. Wir nennen eine Familie $\mathcal{K} \subset \mathcal{P}_p(A)$ \emph{$p$-uniform integrierbar}, falls für alle $\varepsilon>0$ und $a_0 \in A$ ein $R_\varepsilon>0$ existiert, sodass
    $$\sup\limits_{\mu \in \mathcal{K}} \int\limits_{A\setminus B_{R_\varepsilon}(a_0)} d_A^p(a_0, x)\mu(dx) \leq \varepsilon $$
    Für eine Funktion $f: A \rightarrow \mathbb{R}$ sagen wir \emph{f hat $p$-Wachstum}, falls 
    $$|f(x)|\leq a(d_A^p(a_0, x) + 1)$$
    für ein $a\in \mathbb{R}$ und $a_0 \in A$.
\end{definition}
Mit der Dreiecksungleichung gelten beide Eigenschaften wenn sie für ein $a_0 \in A$ gelten schon für alle $a_0 \in A$.
Für Konvergenz in $\mathcal{P}_p(A)$ gilt folgender Zusammenhang:
\begin{lemma}\label{thm:conv_char}
Sei $A$ ein polnischer Raum mit fixierter Metrik $d_A$.Sei $(\mu_n) \subset \mathcal{P}_p(A), \mu \in \mathcal{P}_p(A)$. Dann sind die folgenden äquivalent:
\begin{enumerate}
    \item $\mu_n \rightarrow \mu$ bezüglich $\mathcal{W}_p$
    \item $\mu_n \rightarrow \mu$ schwach und $(\mu_n)$ sind $p$-uniform integrierbar.
    \item $\mu_n(f) \rightarrow \mu(f)$ für jedes stetige $f$ mit $p$-Wachstum.
    \item $\mu_n \rightarrow \mu$ schwach und $\mu_n(d_A^p(\cdot, a_0)) \rightarrow \mu(d_A^p(\cdot, a_0))$ für ein $a_0 \in A$
\end{enumerate}
\end{lemma}
\begin{proof}
% TODO: Referenz Paper Ambrosio Giggli
Wir beweisen die Äquivalenz zwischen den Punkten (2) bis (4). Die Anbindung an Punkt (1) ist umfangreicher und kann zum Beispiel bei (TODO Quelle Villani, OT old and new) gefunden werden. \\ 

(2)$\Rightarrow$(3): \\
Wir können $f$ in $f_+ = \max(0, f)$ und $f_-=\max(0, -f)$ zerlegen mit $f=f_+-f_-$. Diese sind nichtnegativ und weiterhin stetig mit $p$-Wachstum. Wir können also annehmen, dass $f\geq 0$. 

Für $R>0$ seien $\chi_R:A\rightarrow[0,1]$ stetig mit kompaktem Träger und $\chi_{R_{\vert_{B_R(a_0)}}}=1$, monoton wachsend in $R$. Wir können $f$ von unten approximieren durch stetige beschränkte Funktionen $f_m = f\chi_m$. Es gilt $\mu(f) = \lim\limits_{m\rightarrow \infty} \mu(f_m)$ nach monotoner Konvergenz und für jedes $m \in \mathbb{N}$ gilt 
$$\mu(f_m) = \lim\limits_{n\rightarrow\infty}\mu_n(f_m) \leq \liminf\limits_{n\rightarrow\infty}\mu_n(f)$$
und somit auch 
$$\mu(f) = \lim_{m\rightarrow\infty} \mu(f_m) \leq \liminf\limits_{n\rightarrow\infty}\mu_n(f)$$
Für die andere Ungleichung, fixiere $\varepsilon>0, a_0 \in A$ und wähle $R>1$ sodass
$$\sup\limits_{n \in \mathbb{N}} \int\limits_{A\setminus B_R(a_0)}d_A^p(a_0, x)\mu_n(dx) < \varepsilon$$
Setze $\chi:=\chi_R$.
Nun ist, da $f(x)\leq C(1+d_A^p(a_0, x)) \leq 2Cd_A^p(a_0, x), x\notin B_r(a_0)$ 
$$\int fd\mu_n = \int f\chi d\mu_n + \int f(1-\chi)d\mu_n \leq \int f\chi d\mu_n + 2C\varepsilon \rightarrow \mu(\chi f) + 2C\varepsilon$$
und 
$$\limsup_{n\rightarrow\infty}\mu_n(f) \leq \mu(\chi f) + 2C\varepsilon \leq \mu(f) + 2C\varepsilon$$
Da $\varepsilon$ beliebig folgt $\mu_n(f) \rightarrow \mu(f)$

(3)$\Rightarrow$(4) ist klar, da $d^p_A(a_0, \cdot)$ stetig mit $p$-Wachstum ist.

(4)$\Rightarrow$(2): \\
Angenommen es existiert ein $\varepsilon > 0$ und $a_0 \in A$ sodass für jedes $R>0$ 
\begin{equation} \label{eq:1}
\sup\limits_{n\in\mathbb{N}}\int_{A\setminus B_R(a_0)}d_A^p(a_0, x)\mu_n(dx)>\varepsilon
\end{equation}
Beachte, dass es für jedes $R>0$ unendlich viele $n \in \mathbb{N}$ geben muss, die \ref{eq:1} erfüllen: Ansonsten könnte man R so vergrößern, dass für die endlich vielen Terme das Integral unter $\varepsilon$ gezwungen wird, und hätte damit einen Widerspruch. Es gilt also
$$\limsup\limits_{n\in\mathbb{N}}\int_{A\setminus B_R(a_0)}d^p_A(a_0, x)\mu_n(dx)>\varepsilon$$
Wähle für jedes $R>0$ $\chi_R$ stetig mit kompaktem Träger in $B_R(a_0)$ und identisch $1$ auf $B_{\frac{R}{2}}(a_0)$.
\begin{align*}
    \int d^p_A(a_0, x)\chi_R\mu(dx) &= \lim\limits_{n\rightarrow\infty}\int d^p_A(a_0, x)\chi_R \mu_n(dx) \\
    &= \lim\limits_{n\rightarrow\infty}\left(\int d^p_A(a_0, x)\mu_n(dx) - \int d^p_A(a_0, x)(1-\chi_R)\mu_n(dx) \right) \\
    &= \int d^p_A(a_0, x)\mu(dx) - \lim\limits_{n\rightarrow\infty}\int d^p_A(a_0, x)(1-\chi_R)\mu_n(dx) \\
    &\leq \int d^p_A(a_0, x)\mu(dx) - \limsup\limits_{n\rightarrow\infty} \int_{A\setminus B_R(a_0)}d^p_A(a_0, x)\mu_n(dx) \\
    &\leq \int d^p_A(a_0, x)\mu(dx) - \varepsilon
\end{align*}
und nun folgt
$$\int d^p_A(a_0, x) = \lim\limits_{n\rightarrow\infty} \int d^p_A(a_0, x)\chi_n\mu(dx) \leq \int d^p_A(a_0, x)\mu(dx) - \varepsilon$$
was ein Widerspruch ist.
\end{proof}
\begin{lemma} \label{thm:weak_topology_metric}
Sei $A$ ein polnischer Raum mit fixierter Metrik $d_A$. Betrachte weiterhin die beschränkte Metrik $\widehat{d}:=d_A \wedge 1$. Für Verteilungen $\mu_n \subset \mathcal{P}(A)$, $\mu \in \mathcal{P}(A)$ konvergieren $\mu_n \rightarrow \mu$ schwach genau dann, wenn $\mu_n \rightarrow \mu$ bezüglich $\mathcal{W}_p$ auf $(A, \widehat{d})$. Die beschränkte Wassersteinmetrik metrisiert also die schwache Topologie.
\end{lemma}
\begin{proof}
    Gelte zunächst $\mu_n \rightarrow \mu$ schwach und fixiere ein $a_0 \in A$. Die Funktion $\widehat{d}^p(\cdot, a_0)$ ist stetig und beschränkt, also gilt $\mu_n(\widehat{d}^p(\cdot, a_0)) \rightarrow \mu(\widehat{d}^p(\cdot, a_0))$ und mit Lemma \ref{thm:conv_char} folgt $\mu_n \rightarrow \mu$ bezüglich $\mathcal{W}_p$ auf $(A, \widehat{d})$.

    Umgekehrt, gelte $\mu_n \rightarrow \mu$ bezüglich $\mathcal{W}_p$ auf $(A, \widehat{d})$. Die Frage von schwacher Konvergenz ist nur eine Frage der Topologie und nicht der konkreten Metrik, und die Topologien auf $(A, d_A)$ und $(A, \widehat{d})$ sind identisch. Somit folgt auch wieder aus Lemma \ref{thm:conv_char}, dass $\mu_n \rightarrow \mu$ schwach.
\end{proof}
\begin{remark}
    Die Wahl von $\widehat{d}$ als $d_A \wedge 1$ ist nicht zentral für den Beweis, wichtig ist lediglich dass die Metrik beschränkt ist und bei kleinen Abständen identisch, damit die gleiche Topologie erzeugt wird. Wir werden dieses Lemma später auch auf Produkträumen $X \times Y$ benutzen, in denen wir in den einzelnen Räumen die Metrik beschränken und dann die Produktmetrik dieser neuen Metriken verwenden. Das ist kein Problem, da die Metrik trotzdem beschränkt und bei kleinen Abständen identisch ist.
\end{remark}
\subsection{Bedingte Erwartungen und Bedingte Verteilungen}
\begin{definition}
Seien $(\Omega, \mathcal{F}), (S, \mathcal{S})$ messbare Räume. Mit einem stochastischen Kern $\mu:\Omega \rightarrow S$ bezeichnen eine Abbildung $\Omega \rightarrow \mathcal{P}(S), x\mapsto \mu_x$ sodass für jede Menge $A \in \mathcal{S}$ die Evaluations-Abbildung $x \mapsto \mu_x(A)$ messbar bezüglich der Borel $\sigma$-Algebra auf $[0,1]$ ist.
\end{definition}
Die bedingte Verteilung wird ein Kernbaustein der Konstruktion vom Informationsprozess. Die Existenz beruht auf dem Folgenden Satz:
%TODO: Herausfinden ob S wirklich polnisch sein muss, Referenz Kallenberg
\begin{theorem}\label{thm:disintegration}
Seien $(S, \mathcal{S}), (T,\mathcal{T})$ polnische Räume mit ihren Borel $\sigma$-Algebren. Sei $\rho$ eine Verteilung auf $S\times T$ und $\nu$ die Marginalie von $\rho$ über $S$, d.h. $\nu(A) = \rho(A\times T)$. Dann gibt es einen $\nu$-fast sicher eindeutigen stochastischen Kern $\mu:S\rightarrow T$, sodass $\rho = \nu \otimes \mu$.
\end{theorem}
\begin{definition}
Für zwei Zufallsvariablen $X, Y$ auf $(\Omega, \mathcal{A}, \mathbb{P})$ mit Werten in polnischen Räumen $(S, \mathcal{S})$ und $(T, \mathcal{T})$ existiert nach \ref{thm:disintegration} ein fast sicher eindeutiger Kern $\mu: S\rightarrow T$ mit $\mathbb{P}^{X, Y}=\mathbb{P}^X\otimes \mu$. Diesen bezeichnen wir als \emph{bedingte Verteilung von $Y$ bezüglich $X$} und schreiben $\mathcal{L}(Y \vert X)$.

Für eine $\sigma$-Algebra $\mathcal{F} \subset \mathcal{A}$ definieren wir (falls $\Omega$ polnisch ist) die bedingte Verteilung $\mathcal{L}(Y\vert \mathcal{F})$ wie zuvor bezüglich der Identitätsabbildung $\operatorname{id}:(\Omega, \mathcal{A}) \rightarrow (\Omega, \mathcal{F})$, das heißt als den fast-sicher eindeutigen $\mathcal{F}$-messbaren Kern $\mu:\Omega\rightarrow S$, für den gilt $\left(\mathbb{P}_{\vert \mathcal{F}} \otimes \mu\right)(A\times B)=\mathbb{P}(A, Y\in B)$ für alle $A \in \mathcal{F}, B\in \mathcal{S}$.
\end{definition}
Eng verwandt mit der bedingten Verteilung ist die bedingte Erwartung:
\begin{definition}
Für eine reellwertige, integrierbare Zufallsvariable $X: (\Omega, \mathcal{F}) \rightarrow (\mathbb{R}, \mathcal{B}(\mathbb{R}))$ und eine Unter-$\sigma$-Algebra $\mathcal{G}\subset \mathcal{F}$ definieren wir die bedingte Erwartung $\mathbb{E}(X\vert \mathcal{G})$ als die fast-sicher eindeutige $\mathcal{G}$-messbare Zufallsvariable $\tilde{X}$, sodass für alle beschränkten $\mathcal{G}$-messbaren $Y$
$$\mathbb{E}(\tilde{X}Y) = \mathbb{E}(XY)$$
Für Zufallsvariablen $X$ und $Y$ schreiben wir $\mathbb{E}(Y\vert X)$ für $\mathbb{E}(Y \vert \sigma(X))$.
\end{definition}
Die bedingte Verteilung und die bedingte Erwartung haben folgenden Zusammenhang:
\begin{lemma}\label{thm:law_expectancy_connection}
Seien $X: (\Omega, \mathcal{F})\rightarrow (S, \mathcal{S}), Y: (\Omega, \mathcal{F})\rightarrow(T, \mathcal{T})$ Zufallsvariablen mit Werten in polnischen Räumen $(S, \mathcal{S})$ und $(T, \mathcal{T})$ und sei $\mu: S\rightarrow T$ ein stochastischer Kern. Dann ist $\mu = \mathcal{L}(Y\vert X)$ genau dann wenn für alle messbaren, beschränkten $f: T\rightarrow \mathbb{R}$
$$\mathbb{E}(f(Y) \vert X) = \int f(y)\mu_X(dy) \text{ fast sicher}$$
\end{lemma}
\begin{proof}
    "$\Rightarrow$": \\
    Sei $f:T\rightarrow \mathbb{R}$ messbar und beschränkt. Mit einem Funktionserweiterungsargument ist $\int f(y)\mu_X(dy)$ messbar bezüglich $\sigma(X)$. Für Mengen $A' \in \sigma(X), A'=X^{-1}(A)$ ist 
    \begin{align*}
    \mathbb{E}(f(Y(\omega))\mathds{1}_{A'}(\omega)) &= \mathbb{E}(f(Y)\mathds{1}_A(X))\\
    &=\int \int f(y) \mathds{1}_A(x)\mu_x(dy)\mathbb{P}^X(dx) \\
    &= \int \mathds{1}_{A'}(\omega) \int f(y)\mu_{X(\omega)}(dy) \mathbb{P}(d\omega)
    \end{align*}
    Mit einem Funktionserweiterungsargument folgt für alle beschränkten, $\sigma(X)$ messbaren $g: \Omega\rightarrow \mathbb{R}$
    $$\mathbb{E}(f(Y(\omega))g(\omega)) = \int g(\omega)\int f(y)\mu_{X(\omega)}(dy)\mathbb{P}(d\omega)$$
    und damit die Behauptung. \\
    "$\Leftarrow$": \\
    Seien $A \in \mathcal{S}, B\in \mathcal{T}$. Dann gilt
    \begin{align*}
        \mathbb{P}(X\in A, Y\in B) &= \mathbb{E}(\mathds{1}_A(X) \mathds{1}_B(Y)) \\
        &= \mathbb{E}(\mathds{1}_A(X)\mathbb{E}(\mathds{1}_B(Y)\vert X)) \\
        &= \int \int \mathds{1}_B(Y) \mu_x(dy) \mathds{1}_A(x)\mathbb{P}^X(dx) \\
        &= (\mathbb{P}^X \otimes \mu)(A\times B)
    \end{align*}
    und somit ist $\mu=\mathcal{L}(Y\vert X)$
\end{proof}
\begin{lemma}\label{thm:kernel_characterization}
    Seien $(S, \mathcal{S}), (T, \mathcal{T})$ polnische Räume und $\mu: S\rightarrow \mathcal{P}_p(T)$ eine Abbildung. $\mu$ ist ein stochastischer Kern, genau dann wenn es eine messbare Abbildung bezüglich der Borel-Algebra auf $\mathcal{P}_p$ ist.
\end{lemma}
\begin{proof}
"$\Rightarrow$": \\
Die $\sigma$-Algebra auf $\mathcal{P}_p$ wird nach Lemma \ref{thm:conv_char} von der gröbsten Topologie erzeugt, bezüglich der die Abbildungen $\pi_f: \mu \mapsto \mu(f)$ für $f$ stetig mit $p$-Wachstum stetig sind. Daher wird auch die Borel-Algebra von diesen Abbildungen erzeugt. Damit die Abbildung $\mu: x\mapsto \mu_x$ müssen also genau alle Abbildungen $\pi_f \circ \mu: x\mapsto \mu_x(f)$ messbar sein. Das sind sie aber über ein Funktionserweiterungsargument sogar für alle integrierbaren, messbaren $f$: Für Indikatorfunktionen $\chi_A$ sind das genau die Abbildungen $x\mapsto \mu_x(A)$ die nach Voraussetzung messbar sind, und Messbarkeit bezüglich der Borel-Algebra auf $\mathbb{R}$ ist abgeschlossen unter Linearkombinationen und Limiten. Somit ist die Abbildung $x \mapsto \mu_x$ messbar bezüglich der Borel-Algebra auf $\mathcal{P}_p$. \\
"$\Leftarrow$": \\
Sei nun die Abbildung $x \mapsto \mu_x$ messbar. Um zu zeigen, dass Abbildungen $x\mapsto \mu_x(A)$ messbar sind, reicht es zu zeigen, dass die Evaluationsabbildungen $\mu \mapsto \mu(A)$ messbar sind bezüglich der Borel-Algebra auf $\mathcal{P}_p(T)$. Wir setzen
$$\mathcal{C}:=\left\{A \in \mathcal{T} \vert \mu \mapsto \mu(A) \text{ ist messbar}\right\}$$
Betrachte zunächst offene Mengen $U\in \mathcal{T}$. Für eine Folge $\mu_n \rightarrow \mu$ bezüglich $\mathcal{W}_p$ gilt insbesondere $\mu_n\rightarrow \mu$ schwach. Somit gilt mit dem Portmonteau Theorem
$$\liminf_{n\rightarrow\infty}\mu_n(U) \geq \mu(U)$$
Die Abbildung $\mu \mapsto \mu(U)$ ist also halbstetig von unten und somit messbar. Die offenen Mengen sind ein $\cap$-stabiler Erzeuger von $\mathcal{T}$, es reicht also zu zeigen dass $\mathcal{C}$ ein Dynkin-System ist. Für $A\in\mathcal{C}$ ist die Abbildung $\mu \mapsto \mu(A^c)=1-\mu(A)$ wieder messbar, und für $(A_i)_{i\in\mathbb{N}}\subset \mathcal{C}$ disjunkt ist 
$\mu\mapsto \mu(\bigcup_{i\in\mathbb{N}}A_i)=\sum_{i\in\mathbb{N}}\mu(A_i)$ auch messbar. Somit ist $\mathcal{C}=\mathcal{T}$.
\end{proof}
\begin{remark}\label{rem:kernel_char_no_p}
Mit dem gleichen Argument gilt die Behauptung auch für Abbildungen $\mu: S \mapsto \mathcal{P}(T)$, wenn wir auf $\mathcal{P}(T)$ die Borel-Algebra betrachten, die durch die Topologie schwacher konvergenz erzeugt wird.
\end{remark}
\begin{corollary}\label{thm:pmoments}
    Sei $X:(\Omega, \mathcal{F})\rightarrow(S, \mathcal{S})$ eine Zufallsvariable mit Werten in einem polnischen Raum $S$ mit fixierter Metrik $d$. Weiterhin sei $\mathcal{G}\subset \mathcal{F}$ und $X$ habe $p$-te Momente, das heißt $\mathbb{E}(d^p(a_0, X))<\infty$. Dann gelten folgende Aussagen:
    \begin{enumerate}
        \item Wir können $\mathcal{L}(X\vert \mathcal{G})$ als eine messbare Abbildung $\Omega\rightarrow\mathcal{P}_p(S)$ wählen.
        \item $\mathcal{L}(X\vert \mathcal{G})$ hat selbst wieder $p$-te Momente bezüglich der Wasserstein-Metrik.
    \end{enumerate}
\end{corollary}
\begin{proof}
\begin{enumerate}
    \item Sei $\mu:\Omega\rightarrow\mathcal{P}(S)$ eine beliebige Version der bedingten Verteilung. Betrachte die Menge $A:=\{\omega\in\Omega\vert \mu_\omega(d^p(a_0, \cdot)) = \infty\}$. Da 
$$\int_{\Omega}\int_{S} d^p(a_0, x)\mu_{\omega}(dx)\mathbb{P}(d\omega) = \mathbb{E}(d^p(a_0, X))<\infty$$
ist $A$ eine Nullmenge. Setze nun 
$$\tilde{\mu}_\omega=\mathds{1}_{A^c}(\omega)\mu_\omega + \mathds{1}_{A}\delta_{a_0}$$
Für $B\in\mathcal{S}$ ist $\omega\mapsto\tilde{\mu}_\omega(B) = \omega \mapsto \mathds{1}_{A^c}\mu_\omega(B)+\mathds{1}_A \delta_{a_0}$ weiterhin messbar als Kombination messbarer Abbildungen, $\tilde{\mu}$ ist also ein Kern. Da $A$ eine Nullmenge ist, ist $\mathbb{P}_{\vert \mathcal{G}}\otimes \tilde{\mu} = \mathbb{P}_{\vert\mathcal{G}} \otimes \mu$, somit ist $\tilde{\mu}$ eine Version von $\mathcal{L}(X\vert \mathcal{G})$ mit Werten in $\mathcal{P}_p$. Nach dem vorherigen Lemma ist sie messbar bezüglich der Borel-Algebra auf $\mathcal{P}_p$.
\item Wie immer können wir die fixierte Stelle gegenüber der wir $p$-te Momente berechnen frei wählen. Eine einfache Wahl ist $\delta_{a_0}$ für ein $a_0\in S$, da es nur eine Möglichkeit der Kopplung von Dirac-Maßen in der Definition der Wasserstein-Metrik gibt: Das Produktmaß. Es gilt nun
$$\mathbb{E}\left(\mathcal{W}_p^p\left(\mathcal{L}(X\vert\mathcal{G}), \delta_{a_0}\right)\right)=\mathbb{E}\left(\int d^p(a_0, x)\mathcal{L}(X\vert\mathcal{G})(dx)\right)=\mathbb{E}\left(d^p(a_0, X)\right) < \infty$$
\end{enumerate}
\end{proof}
\begin{lemma}\label{thm:kernel_prod}
Seien $\kappa_1: \Omega\rightarrow T,\kappa_2: \Omega\rightarrow S$ Kerne. Dann ist auch $\omega \mapsto \kappa_1(\omega) \otimes \kappa_2(\omega)$ ein Kern.
\end{lemma}
\begin{proof}
Schreibe $\mu:=\kappa_1\otimes\kappa_2$ und setze 
$$\mathcal{C}:=\left\{C\subset\sigma(A\times B, A\in\mathcal{T}, B\in\mathcal{S})\vert \mu(C) \text{ ist messbar}\right\}$$
$\mathcal{C}$ ist ein Dynkinsystem: Für $C\in\mathcal{C}$ ist $\mu(C^c)=1-\mu(C)$ wieder messbar, und für $(C_i)_{i\in\mathbb{N}}\subset \mathcal{C}$ ist 
$$\mu(\bigcup_{i\in\mathbb{N}}(C_i))=\sum_{i\in\mathbb{N}}\mu(C_i)$$
auch wieder messbar. Ein $\cap$-stabiler Erzeuger sind Mengen der Form $A\times B, A\in \mathcal{T}, B\in\mathcal{S}$. Für diese Mengen gilt
$$\mu(A\times B) = \kappa_1(A)\times\kappa_2(B)$$
und das ist wieder messbar als Produkt messbarer Funktionen. Insgesamt ist $\kappa_1\otimes\kappa_2$ wieder ein Kern.
\end{proof}
\begin{lemma}\label{thm:determined_kernel}
Seien $X, Y$ Zufallsvariablen auf $(\Omega, \mathcal{F})$ mit Werten in polnischen Räumen $S$ und $T$. Sei $\mathcal{G}\subset \mathcal{F}$ mit $\sigma(X)\subset \mathcal{G}$. Dann ist 
$$\mathcal{L}\left((X,Y)\vert \mathcal{G}\right) = \delta_X \otimes \mathcal{L}(Y\vert \mathcal{G})$$
\end{lemma}
\begin{proof}
    $\delta_X$ ist ein Kern und messbar bezüglich $\sigma(X)\subset \mathcal{G}$, und auch $\mathcal{L}(Y\vert \mathcal{G})$ ist ein $\mathcal{G}$-messbarer Kern. Somit ist mit dem vorherigen Lemma auch $\delta_X \otimes \mathcal{L}(Y\vert\mathcal{G})$ ein $\mathcal{G}$ messbarer Kern. Ferner gilt für Mengen $A\in \mathcal{G}, B\in\mathcal{S}, C \in \mathcal{S}$:
    \begin{align*}
        \mathbb{P}_{\vert\mathcal{G}} \otimes &\left(\delta_X\otimes \mathcal{L}(Y\vert \mathcal{G})\right)(A\times(B\times X)) \\
        &= \int \int \mathds{1}_A(\omega)\mathds{1}_B(x)\mathds{1}_C(y) (\delta_X\otimes \mathcal{L}(Y\vert\mathcal{G}))(dx, dy)\mathbb{P}_{\vert\mathcal{G}}(d\omega) \\
        &= \int \mathds{1}_A(\omega) \mathds{1}_B(X)\int\mathds{1}_C(y)\mathcal{L}(Y\vert\mathcal{G})(dy)\mathbb{P}_{\vert\mathcal{G}}(d\omega) \\
        &= \mathbb{E}\left(\mathds{1}_A(\omega)\mathds{1}_B(X(\omega))\mathbb{E}(\mathds{1}_C(Y)\vert \mathcal{G})\right) \\
        &= \mathbb{E}(\mathds{1}_A(\omega)\mathds{1}_B(X)\mathds{1}_C(Y)) \\
        &= \mathbb{P}(A, X\in B, Y\in C)
    \end{align*}
    Somit gilt 
    $$\mathbb{P}_{\vert\mathcal{G}} \otimes \left(\delta_X\otimes \mathcal{L}(Y\vert \mathcal{G})\right)(A, (X, Y) \in E) = \mathbb{P}(A, (X, Y)\in E)$$
    für Mengen $E$ der Form $E=A\times B$. Das ist ein $\cap$-stabiler Erzeuger von $\mathcal{S}\otimes\mathcal{T}$, und somit gilt die Gleichheit auch allgemein.
\end{proof}
\begin{lemma}\label{thm:pushforward_measurable}
Seien $S, T$ polnische Räume mit Borel-Algebra. Sei $f:S\rightarrow T$ beschränkt und messbar. Dann ist die \emph{Push-Forward Abbildung} 
$$f_*:\mathcal{P}_p(S)\rightarrow\mathcal{P}_p(T), \, \mu \mapsto f_*(\mu)\quad  \text{ mit } f_*(\mu)(A) = \mu(f^{-1}(A))$$
messbar. Falls $f$ stetig ist, so ist es auch $f_*$.
\end{lemma}
\begin{proof}
Für $\mu \in \mathcal{P}_p(S)$ und $t_0 \in T$ fix gilt, da $f$ beschränkt ist
$$\int d(t_0, x) f_*(\mu)(dx) = \int d(t_0, f(s))\mu(ds) < \infty$$
Die Abbildung ist also wohldefiniert.
Mit Lemma \ref{thm:kernel_characterization} ist $f_*$ messbar genau dann, wenn für jedes $A \in \mathcal{T}$ die Abbildung $\mu \mapsto (f_*(\mu))(A)=\mu(f^{-1}(A))$ messbar ist. Das ist aber klar: Auf $\mathcal{P}_p(S)$ ist die Identität messbar und somit gilt, auch mit Lemma \ref{thm:kernel_characterization}, dass $\mu \mapsto \mu(B)$ messbar ist für alle $B\in \mathcal{S}$, also insbesondere für $f^{-1}(A) \in \mathcal{S}$. 

Sei nun $f$ stetig und $(\mu_n)_{n\in\mathbb{N}}, \mu \in \mathcal{P}_p(S)$ mit $\mu_n\rightarrow \mu$ bezüglich $\mathcal{W}_p$. Sei $g:T\rightarrow \mathbb{R}$ stetig mit $p$-Wachstum, das heißt $|g(x)| \leq c(d(x, s_0)+1)$ für fixierte $c\in\mathbb{R}, s_0\in S$. Dann gilt
    $$(f_*(\mu_n))(g) = \int g(f(s)) \mu(ds)$$
Für die Funktion $g(f(s))$ gilt $|g(f(s))|\leq c(d(f(s), s_0)+1)$ und das ist beschränkt, da $f$ beschränkt ist. Somit ist $g\circ f$ beschränkt und $\mu_n(g\circ f) \rightarrow \mu(g\circ f) = (f_*(\mu))(g)$. Insgesamt ist $f_*$ stetig.
\end{proof}
\begin{remark}
Mit Bemerkung \ref{rem:kernel_char_no_p} ist für ein (möglicherweise nicht beschränkts) messbares $f: S\rightarrow T$ mit dem gleichen Argument $f_*$ auch als Abbildung $f_*: \mathcal{P}(S) \rightarrow \mathcal{P}(T)$ messbar.
\end{remark}
\begin{corollary}\label{thm:pushforward_law}
Seien $S, T$ polnische Räume, $f:S\rightarrow T$ messbar. Weiterhin sei $X:(\Omega, \mathcal{F}) \rightarrow (S, \mathcal{S})$ und $\mathcal{G}\subset\mathcal{F}$. Dann ist 
$$\mathcal{L}(f(X)\vert \mathcal{G}) = f_*\mathcal{L}(X\vert\mathcal{G})$$
\end{corollary}
\begin{proof}
Mit dem vorherigen Lemma und der anschließenden Bemerkung ist $f_*\mathcal{L}(X\vert\mathcal{G})$ eine $\mathcal{G}$-messbare Abbildung. Weiter gilt für $A\in\mathcal{G}, B\in\mathcal{T}$
\begin{align*}
    (\mathbb{P}\otimes f_*\mathcal{L}(X\vert \mathcal{G}))(A\times B) &= \int \mathds{1}_A(\omega) \int \mathds{1}_B(t) f_*(\mathcal{L}(X\vert\mathcal{G}))(dt) \mathbb{P}(d\omega) \\
    &= \int \mathds{1}_A(\omega) \int \mathds{1}_{f^{-1}(B)}(s)\mathcal{L}(X\vert\mathcal{G})(ds) \mathbb{P}(d\omega) \\
    &= \mathbb{P}(A, X\in f^{-1}(B)) \\
    &= \mathbb{P}(A, f(X) \in B)
\end{align*}
\end{proof}

\begin{lemma}\label{thm:pushforward_expectancy}
Sei $(\Omega, \mathcal{F}, \mathbb{P})$ ein Wahrscheinlichkeitsraum, $(S, \mathcal{S})$ ein polnischer Raum. Weiterhin seien $X: \Omega \rightarrow S$ messbar und $U: S\rightarrow \mathbb{R}$ beschränkt und messbar. Betrachte zwei $\sigma$-Algebren $\mathcal{G}\subset \mathcal{F}$ und $\mathcal{A} \subset \mathcal{S}$, sodass $\mathcal{G}$ die kleinste $\sigma$-Algebra bezüglich der $X: (\Omega, \mathcal{G}) \rightarrow (S, \mathcal{A})$ messbar ist. Dann gilt
$$\mathbb{E}_{\mathbb{P}}(U(X) \vert \mathcal{G}) = \mathbb{E}_{\mathbb{P}^X}(U \vert \mathcal{A})(X) \quad \text{ fast sicher}$$
\end{lemma}
\begin{proof}
Schreibe $\mu := \mathbb{P}^X$. Da $X: (\Omega, \mathcal{G}) \rightarrow (S, \mathcal{A})$ messbar ist, ist auch $\mathbb{E}_\mu(U\vert \mathcal{A})(X)$ $\mathcal{G}$-messbar. Für eine $\mathcal{G}$-messbares, beschränktes $V:\Omega \rightarrow \mathbb{R}$ faktorisiert $V$ als $V(\omega) = \tilde{V}(X(\omega))$ für ein $\mathcal{A}$-messbares $\tilde{V}$. Somit gilt
\begin{align*}
\int V(\omega)U(X(\omega))\mathbb{P}(d\omega) &= \int \tilde{V}(X)U(X) \mu(dX)  \\
&= \int \tilde{V}(X)\mathbb{E}_\mu(U \vert \mathcal{A})(X) \mu(dX) \\
&= \int \tilde{V}(X(\omega)) \mathbb{E}_\mu(U \vert \mathcal{A})(X(\omega)) \mathbb{P}(d\omega) \\
&= \int V(\omega) \mathbb{E}_\mu(U \vert \mathcal{A})(X(\omega)) \mathbb{P}(d\omega) \\
\end{align*}
und damit ist $\mathbb{E}_{\mathbb{P}^{X}}(U \vert \mathcal{A})(X)$ eine Version der bedingten Erwartung $\mathbb{E}_{\mathbb{P}}(U(X) \vert \mathcal{G})$.
\end{proof}

\subsection{Kopplungen}
\begin{definition}[Bedingte Unabhängigkeit]
    Für einen Wahrscheinlichkeitsraum $(\Omega, \mathcal{F}, \mathbb{P})$, eine Unter $\sigma$-Algebra $\mathcal{G} \subset \mathcal{F}$ und Mengen $A, B \in \mathcal{F}$ schreiben wir $\mathbb{P}(A \vert \mathcal{G}) := \mathbb{E}(\mathds{1}_A\vert \mathcal{G})$ und nennen $A$ und $B$ \emph{unabhängig bedingt auf $\mathcal{G}$}, falls
    \begin{equation}\label{eq:def_cond_ind}
    \mathbb{P}(A\cap B\vert \mathcal{G}) = \mathbb{P}(A\vert \mathcal{G}) \mathbb{P}(B \vert \mathcal{G}) \quad \text{ fast sicher }
    \end{equation}
    Wir nennen Mengensysteme $(\mathcal{E}_i)_{i\in I}$ unabhängig bedingt auf $\mathcal{G}$, falls jede endliche Auswahl von Mengen $A_t \in \mathcal{E}_{i_t}, t=1,...,n$ die Gleichung
    $$\mathbb{P}\left(\bigcap_{t=1}^n A_t\vert \mathcal{G}\right) = \prod_{t=1}^n \mathbb{P}(A_t \vert \mathcal{G}) \quad \text{ fast sicher }$$
    erfüllt.
\end{definition}
\begin{definition}[Filtrierter Prozess]
Betrachte ein Fünf-Tupel
$$\mathbb{X}=\left(\Omega, \mathcal{F}, \mathbb{P}, \left(\mathcal{F}_t\right)_{t=1}^N, \left(X_t\right)_{t=1}^N\right)$$
wobei $(\Omega, \mathcal{F}, \mathbb{P})$ ein Wahrscheinlichkeitsraum, $\left(\mathcal{F}_t\right)_{t=1}^N\subset \mathcal{F}$ eine Filtration und \\
$(X_t)_{t=1}^N$ ein stocahstischer Prozess mit Werten in $\mathcal{X}_{1:N}$ adaptiert an $(\mathcal{F})_{t=1}^N$. Ein solches Tupel $\mathbb{X}$ nennen wir einen \emph{filtrierten (stochastischen) Prozess}. Wir schreiben $\mathcal{FP}$ für den Raum aller stochastischen Prozess und $\mathcal{FP}_p$ für den Raum aller stocahstischen Prozess mit $p$-ten Momenten, das heißt $\mathbb{E}(d_{\mathcal{X}_t}(a_0, X_t))<\infty, a_0\in\mathcal{X}_t, t=1,...,N$.
\end{definition}
\begin{definition}[Kausale Kopplungen]
Seien $\mathbb{X}, \mathbb{Y}$ filtrierte Prozesse. Wir nennen $\pi$ eine \emph{Kopplung} von $\mathbb{X}$ und $\mathbb{Y}$, falls die Marginalien $\mathbb{P}^\mathbb{X}$ und $\mathbb{P}^\mathbb{Y}$ sind (das heißt $\pi \in \cpl(\mathbb{P}^\mathbb{X}, \mathbb{P}^\mathbb{Y})$). Weiterhin nennen wir $\pi$
\begin{enumerate}
\item \emph{kausal} (oder kausal von $\mathbb{X}$ zu $\mathbb{Y}$) falls für jedes $1\leq t\leq N$, bedingt auf $\mathcal{F}_{t, 0}^{\mathbb{X}, \mathbb{Y}}$, die Mengensysteme $\mathcal{F}_{N, 0}^{\mathbb{X}, \mathbb{Y}}$ und $\mathcal{F}_{0, t}^{\mathbb{X},\mathbb{Y}}$ unabhängig sind.
\item \emph{antikausal} (oder kausal von $\mathbb{Y}$ zu $\mathbb{X}$), falls für jedes $1 \leq t \leq N$, bedingt auf $\mathcal{F}_{0, t}^{\mathbb{X}, \mathbb{Y}}$, die Mengensysteme $\mathcal{F}_{0, N}^{\mathbb{X}, \mathbb{Y}}$ und $\mathcal{F}_{t, 0}^{\mathbb{X}, \mathbb{Y}}$ unabhängig sind.
\item \emph{bikausal}, falls es kausal und antikausal ist.
\end{enumerate}
Wir schreiben $\cpl(\mathbb{X}, \mathbb{Y})$, $\cplc(\mathbb{X}, \mathbb{Y})$, $\cplbc(\mathbb{X}, \mathbb{Y})$ für die Mengen der Kopplungen, kausalen Kopplungen und bikausalen Kopplungen von $\mathbb{X}$ und $\mathbb{Y}$.
\end{definition}
% TODO: Beweis von Kallenberg übertragen oder zitieren
\begin{lemma}\label{thm:causality_characterization}
Sei $\pi$ eine Kopplung von filtrierten Prozessen $\mathbb{X}$ und $\mathbb{Y}$. Dann sind äquivalent:
\begin{enumerate}
\item $\pi$ ist kausal (von $\mathbb{X}$ zu $\mathbb{Y}$).
\item $\mathbb{E}_\pi(U \vert \mathcal{F}_{t, t}^{\mathbb{X}, \mathbb{Y}}) = \mathbb{E}_\pi(U \vert \mathcal{F}_{t, 0}^{\mathbb{X}, \mathbb{Y}})$ für alle $1\leq t\leq N$ und beschränkte, $\mathcal{F}_N^\mathbb{X}$-messbare $U$.
\item $\mathbb{E}_\pi(V\vert \mathcal{F}_{N, 0}^{\mathbb{X}, \mathbb{Y}}) = \mathbb{E}_\pi(V \vert \mathcal{F}_{t, 0}^{\mathbb{X}, \mathbb{Y}})$ für alle $1\leq t\leq N$ und beschränkte, $\mathcal{F}_t^\mathbb{Y}$-messbare $V$.
\end{enumerate}
\end{lemma}